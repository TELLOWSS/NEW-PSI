<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports Filter Test - PSI</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f7fa;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e293b;
            border-bottom: 3px solid #4f46e5;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8fafc;
            border-left: 4px solid #4f46e5;
            border-radius: 6px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
        }
        .test-result.pass {
            background: #dcfce7;
            border: 1px solid #86efac;
            color: #166534;
        }
        .test-result.fail {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            color: #991b1b;
        }
        button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 5px;
        }
        button:hover {
            background: #4338ca;
        }
        .filter-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .control-group label {
            font-weight: 600;
            font-size: 14px;
            color: #64748b;
        }
        .control-group select {
            padding: 8px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th {
            background: #f1f5f9;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            color: #475569;
        }
        td {
            padding: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        .badge.high {
            background: #dcfce7;
            color: #166534;
        }
        .badge.medium {
            background: #fef3c7;
            color: #92400e;
        }
        .badge.low {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” PSI ë³´ê³ ì„œ í•„í„° ê¸°ëŠ¥ ê²€ì¦ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>í…ŒìŠ¤íŠ¸ ëª©ì </h2>
            <p>Reports.tsxì˜ í•„í„°ë§ ë¡œì§ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.</p>
            <ul>
                <li>âœ“ ê³µì¢…(íŒ€) í•„í„° ì •ìƒ ì‘ë™ í™•ì¸</li>
                <li>âœ“ ì•ˆì „ë“±ê¸‰ í•„í„° ì •ìƒ ì‘ë™ í™•ì¸</li>
                <li>âœ“ ë³µí•© í•„í„° (ê³µì¢… + ì•ˆì „ë“±ê¸‰) ë™ì‹œ ì ìš© í™•ì¸</li>
                <li>âœ“ í•„í„° ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì¸ë±ìŠ¤ ì´ˆê¸°í™” í™•ì¸</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>í•„í„° ì»¨íŠ¸ë¡¤</h2>
            <div class="filter-controls">
                <div class="control-group">
                    <label>ê³µì¢… ì„ íƒ</label>
                    <select id="teamFilter" onchange="applyFilters()">
                        <option value="ì „ì²´">ì „ì²´</option>
                        <option value="í˜•í‹€">í˜•í‹€</option>
                        <option value="ì² ê·¼">ì² ê·¼</option>
                        <option value="ë°°ê´€">ë°°ê´€</option>
                        <option value="ì „ê¸°">ì „ê¸°</option>
                        <option value="ë„ì¥">ë„ì¥</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>ì•ˆì „ë“±ê¸‰ ì„ íƒ</label>
                    <select id="levelFilter" onchange="applyFilters()">
                        <option value="ì „ì²´">ì „ì²´ ë“±ê¸‰</option>
                        <option value="ì´ˆê¸‰">ì´ˆê¸‰ (ê³ ìœ„í—˜)</option>
                        <option value="ì¤‘ê¸‰">ì¤‘ê¸‰ (ì£¼ì˜)</option>
                        <option value="ê³ ê¸‰">ê³ ê¸‰ (ìš°ìˆ˜)</option>
                    </select>
                </div>
            </div>
            <button onclick="runAllTests()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <button onclick="clearResults()">ê²°ê³¼ ì´ˆê¸°í™”</button>
        </div>

        <div id="results"></div>

        <div class="test-section">
            <h3>í•„í„°ë§ëœ ê·¼ë¡œì ëª©ë¡</h3>
            <div id="workerCount" style="margin: 10px 0; font-weight: 600; color: #4f46e5;"></div>
            <div id="workerList"></div>
        </div>

        <div class="test-section">
            <h3>í•„í„° ë¡œì§ ì½”ë“œ</h3>
            <pre style="background: #1e293b; color: #e2e8f0; padding: 15px; border-radius: 8px; overflow-x: auto; font-size: 12px;">
// Reports.tsx - Filter Logic
const filteredRecords = useMemo(() => {
    let result = workerRecords;
    if (activeTab === 'team-report' && selectedTeam !== 'ì „ì²´') {
        result = result.filter(r => r.jobField === selectedTeam);
    }
    if (filterLevel !== 'ì „ì²´') {
        result = result.filter(r => r.safetyLevel === filterLevel);
    }
    return result.sort((a,b) => a.name.localeCompare(b.name));
}, [workerRecords, activeTab, selectedTeam, filterLevel]);

// Filter ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì¸ë±ìŠ¤ ì´ˆê¸°í™”
useEffect(() => {
    setPreviewIndex(0);
}, [selectedTeam, filterLevel, activeTab]);
            </pre>
        </div>
    </div>

    <script>
        // Mock worker data
        const mockWorkers = [
            { id: 1, name: 'ê¹€ì² ìˆ˜', jobField: 'í˜•í‹€', safetyLevel: 'ê³ ê¸‰', safetyScore: 95 },
            { id: 2, name: 'ì´ì˜í¬', jobField: 'í˜•í‹€', safetyLevel: 'ì¤‘ê¸‰', safetyScore: 82 },
            { id: 3, name: 'ë°•ë¯¼ìˆ˜', jobField: 'ì² ê·¼', safetyLevel: 'ì´ˆê¸‰', safetyScore: 68 },
            { id: 4, name: 'ìµœê°•ì² ', jobField: 'ì² ê·¼', safetyLevel: 'ê³ ê¸‰', safetyScore: 91 },
            { id: 5, name: 'ì •ëŒ€í˜„', jobField: 'ë°°ê´€', safetyLevel: 'ì¤‘ê¸‰', safetyScore: 79 },
            { id: 6, name: 'ê°•ë¯¼í˜¸', jobField: 'ë°°ê´€', safetyLevel: 'ê³ ê¸‰', safetyScore: 88 },
            { id: 7, name: 'ì¡°ì„±í›ˆ', jobField: 'ì „ê¸°', safetyLevel: 'ì´ˆê¸‰', safetyScore: 71 },
            { id: 8, name: 'ìœ¤ì§€ì€', jobField: 'ì „ê¸°', safetyLevel: 'ì¤‘ê¸‰', safetyScore: 85 },
            { id: 9, name: 'ì„ìˆ˜í˜„', jobField: 'ë„ì¥', safetyLevel: 'ê³ ê¸‰', safetyScore: 93 },
            { id: 10, name: 'í•œë™í›ˆ', jobField: 'ë„ì¥', safetyLevel: 'ì´ˆê¸‰', safetyScore: 65 }
        ];

        let filteredWorkers = [...mockWorkers];
        let testResults = [];

        function applyFilters() {
            const teamFilter = document.getElementById('teamFilter').value;
            const levelFilter = document.getElementById('levelFilter').value;
            
            filteredWorkers = mockWorkers.filter(worker => {
                let passTeam = teamFilter === 'ì „ì²´' || worker.jobField === teamFilter;
                let passLevel = levelFilter === 'ì „ì²´' || worker.safetyLevel === levelFilter;
                return passTeam && passLevel;
            });
            
            displayWorkerList();
        }

        function displayWorkerList() {
            const countDiv = document.getElementById('workerCount');
            const listDiv = document.getElementById('workerList');
            
            countDiv.textContent = `í•„í„°ë§ ê²°ê³¼: ${filteredWorkers.length}ëª…`;
            
            if (filteredWorkers.length === 0) {
                listDiv.innerHTML = '<p style="color: #94a3b8; text-align: center; padding: 20px;">ì¡°ê±´ì— ë§ëŠ” ê·¼ë¡œìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let tableHTML = '<table><thead><tr><th>ì´ë¦„</th><th>ê³µì¢…</th><th>ì•ˆì „ë“±ê¸‰</th><th>ì•ˆì „ì ìˆ˜</th></tr></thead><tbody>';
            filteredWorkers.forEach(worker => {
                const levelClass = worker.safetyLevel === 'ê³ ê¸‰' ? 'high' : worker.safetyLevel === 'ì¤‘ê¸‰' ? 'medium' : 'low';
                tableHTML += `
                    <tr>
                        <td>${worker.name}</td>
                        <td>${worker.jobField}</td>
                        <td><span class="badge ${levelClass}">${worker.safetyLevel}</span></td>
                        <td>${worker.safetyScore}</td>
                    </tr>
                `;
            });
            tableHTML += '</tbody></table>';
            listDiv.innerHTML = tableHTML;
        }

        function testTeamFilter() {
            const resultsDiv = document.getElementById('results');
            const teams = ['í˜•í‹€', 'ì² ê·¼', 'ë°°ê´€', 'ì „ê¸°', 'ë„ì¥'];
            let testPassed = true;
            let testDetails = [];
            
            teams.forEach(team => {
                const expected = mockWorkers.filter(w => w.jobField === team);
                document.getElementById('teamFilter').value = team;
                applyFilters();
                
                const match = filteredWorkers.length === expected.length;
                testDetails.push(`${team}: ${filteredWorkers.length}ëª… (ì˜ˆìƒ: ${expected.length}ëª…) ${match ? 'âœ…' : 'âŒ'}`);
                if (!match) testPassed = false;
            });
            
            // Reset
            document.getElementById('teamFilter').value = 'ì „ì²´';
            applyFilters();
            
            resultsDiv.innerHTML += `
                <div class="test-result ${testPassed ? 'pass' : 'fail'}">
                    <h4>${testPassed ? 'âœ… í†µê³¼' : 'âŒ ì‹¤íŒ¨'} - ê³µì¢… í•„í„° í…ŒìŠ¤íŠ¸</h4>
                    <ul>${testDetails.map(d => `<li>${d}</li>`).join('')}</ul>
                </div>
            `;
            
            return testPassed;
        }

        function testLevelFilter() {
            const resultsDiv = document.getElementById('results');
            const levels = ['ì´ˆê¸‰', 'ì¤‘ê¸‰', 'ê³ ê¸‰'];
            let testPassed = true;
            let testDetails = [];
            
            levels.forEach(level => {
                const expected = mockWorkers.filter(w => w.safetyLevel === level);
                document.getElementById('levelFilter').value = level;
                applyFilters();
                
                const match = filteredWorkers.length === expected.length;
                testDetails.push(`${level}: ${filteredWorkers.length}ëª… (ì˜ˆìƒ: ${expected.length}ëª…) ${match ? 'âœ…' : 'âŒ'}`);
                if (!match) testPassed = false;
            });
            
            // Reset
            document.getElementById('levelFilter').value = 'ì „ì²´';
            applyFilters();
            
            resultsDiv.innerHTML += `
                <div class="test-result ${testPassed ? 'pass' : 'fail'}">
                    <h4>${testPassed ? 'âœ… í†µê³¼' : 'âŒ ì‹¤íŒ¨'} - ì•ˆì „ë“±ê¸‰ í•„í„° í…ŒìŠ¤íŠ¸</h4>
                    <ul>${testDetails.map(d => `<li>${d}</li>`).join('')}</ul>
                </div>
            `;
            
            return testPassed;
        }

        function testCombinedFilter() {
            const resultsDiv = document.getElementById('results');
            
            // Test: í˜•í‹€ + ê³ ê¸‰
            document.getElementById('teamFilter').value = 'í˜•í‹€';
            document.getElementById('levelFilter').value = 'ê³ ê¸‰';
            applyFilters();
            
            const expected1 = mockWorkers.filter(w => w.jobField === 'í˜•í‹€' && w.safetyLevel === 'ê³ ê¸‰');
            const test1Pass = filteredWorkers.length === expected1.length;
            
            // Test: ì² ê·¼ + ì´ˆê¸‰
            document.getElementById('teamFilter').value = 'ì² ê·¼';
            document.getElementById('levelFilter').value = 'ì´ˆê¸‰';
            applyFilters();
            
            const expected2 = mockWorkers.filter(w => w.jobField === 'ì² ê·¼' && w.safetyLevel === 'ì´ˆê¸‰');
            const test2Pass = filteredWorkers.length === expected2.length;
            
            // Reset
            document.getElementById('teamFilter').value = 'ì „ì²´';
            document.getElementById('levelFilter').value = 'ì „ì²´';
            applyFilters();
            
            const allPass = test1Pass && test2Pass;
            
            resultsDiv.innerHTML += `
                <div class="test-result ${allPass ? 'pass' : 'fail'}">
                    <h4>${allPass ? 'âœ… í†µê³¼' : 'âŒ ì‹¤íŒ¨'} - ë³µí•© í•„í„° í…ŒìŠ¤íŠ¸</h4>
                    <ul>
                        <li>í˜•í‹€ + ê³ ê¸‰: ${test1Pass ? 'âœ…' : 'âŒ'} (${filteredWorkers.length}ëª… ì˜ˆìƒë¨)</li>
                        <li>ì² ê·¼ + ì´ˆê¸‰: ${test2Pass ? 'âœ…' : 'âŒ'}</li>
                    </ul>
                </div>
            `;
            
            return allPass;
        }

        function runAllTests() {
            clearResults();
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="test-section"><h3>ğŸ”„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...</h3></div>';
            
            setTimeout(() => {
                resultsDiv.innerHTML = '<div class="test-section"><h3>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3></div>';
                const test1 = testTeamFilter();
                const test2 = testLevelFilter();
                const test3 = testCombinedFilter();
                
                const allPassed = test1 && test2 && test3;
                resultsDiv.innerHTML += `
                    <div class="test-result ${allPassed ? 'pass' : 'fail'}" style="margin-top: 20px; font-size: 18px;">
                        <h3>${allPassed ? 'âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ í†µê³¼' : 'âŒ ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨'}</h3>
                        <p>ê³µì¢… í•„í„°: ${test1 ? 'âœ…' : 'âŒ'} | ì•ˆì „ë“±ê¸‰ í•„í„°: ${test2 ? 'âœ…' : 'âŒ'} | ë³µí•© í•„í„°: ${test3 ? 'âœ…' : 'âŒ'}</p>
                    </div>
                `;
            }, 100);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('teamFilter').value = 'ì „ì²´';
            document.getElementById('levelFilter').value = 'ì „ì²´';
            applyFilters();
        }

        // Initialize
        applyFilters();
    </script>
</body>
</html>
